<!DOCTYPE html>
<html>
<head>
  <title>Geometry, collinear | Ideogram</title>
  <style>body {font: 12px Arial; line-height: 19.6px;}</style>
  <script type="text/javascript" src="../../dist/js/ideogram.min.js"></script>
        <style>
          html, body {
            height: 100%;
            font: 12px Arial;
            line-height: 19.6px;
          }

        </style>
</head>
<body>
  <h1>Geometry, collinear | Ideogram</h1>
  <a href="../">Back to overview</a> |
  <a href="annotations-heatmap">Previous</a> |
  <a href="layout-small">Next</a>
  <p>
    Gene expression in four <a href="https://en.wikipedia.org/wiki/Oligodendroglioma">brain cancer</a>
    samples, showing 1p and 19q deletions.  
    Data from <a href="https://github.com/broadinstitute/inferCNV">inferCNV</a>.  
    Unlike the
    <a href="annotations-heatmap.html">parallel arrangement</a>, this ideogram is
    collinear -- the chromosomes form a line together.
  </p>
  <script type="text/javascript">

    d3 = Ideogram.d3;

    function calculatePercentiles() {
      var annotContainers, annots, i, j, annot,
        values = [];

      annotContainers = ideogram.rawAnnots.annots;

      for (i = 0; i < annotContainers.length; i++) {
        annots = annotContainers[i].annots;
        for (j = 0; j < annots.length; j++) {
          values = values.concat(annots[j].slice(3,));
        }
      }
      values = values.sort();
      percentile_5 = values[Math.round(values.length * 0.05)];
      percentile_50 = values[Math.round(values.length * 0.5)];
      percentile_95 = values[Math.round(values.length * 0.95)];

      ideogram.config.heatmapThresholds = [
        [percentile_5, '#33F'],
        [percentile_95, '#DDD'],
        ['+', '#F33']
      ]
    }
    var legend = [{
      name: 'Expression level',
      rows: [
        {name: 'Low', color: '#33F'},
        {name: 'Normal', color: '#CCC'},
        {name: 'High', color: '#F33'}
      ]
    }];

    ideogram = new Ideogram({
      organism: 'human',
      orientation: 'horizontal',
      geometry: 'collinear',
      chrHeight: 80,
      showFullyBanded: false,
      // showChromosomeLabels: false,
      rotatable: false,
      legend: legend,
      annotationHeight: 30,
      annotationsLayout: 'heatmap',
      onLoadAnnots: calculatePercentiles,
      annotationsPath: '../../dist/data/annotations/oligodendroglioma_cnv_expression.json'
    });
  </script>
</body>
</html>
