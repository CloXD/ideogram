<!DOCTYPE html>
<html>
<head>
  <title>Human | Ideogram</title>
  <script type="text/javascript" src="../../dist/js/ideogram.min.js"></script>
<link rel="icon" type="image/x-icon" href="img/ideogram_favicon.ico">
</head>
<body>
  <h1>Human | Ideogram</h1>
  <a href="../">Overview</a> |
  <a href="multiple-primates">Previous</a> |
  <a href="mouse">Next</a> |
  <a href="https://github.com/eweitz/ideogram/blob/gh-pages/human.html" target="_blank">Source</a>
  <p>
    A human genome is depicted below.  The grey and black bands in each chromosome
    represent
    <a href="https://en.wikipedia.org/wiki/Heterochromatin">heterochromatin</a>.
    The pink region is the area around the
    <a href="https://en.wikipedia.org/wiki/Centromere">centromere</a>, and the blue represents variable regions.
  </p>
  <p>
    This ideogram shows most chromosomes in a
    <a href="https://en.wikipedia.org/wiki/Ploidy">haploid</a> state for
    simplicity.  For more accurate, diploid representation of human genomes,
    see <a href="ploidy-basic">Ploidy, basic</a> and
    <a href="multiple-trio">Multiple, trio</a>.
  </p>
  <script type="text/javascript">

function getLeft(selector) {
      return Math.round(document
        .querySelector(selector)
        .getBoundingClientRect().x);
    }

    function getRight(selector) {
      return Math.round(document
        .querySelector(selector)
        .getBoundingClientRect().right);
    }

    var config = {
      organism: 'human',
      assembly: 'GRCh37',
      chrHeight: 800,
      dataDir: '/dist/data/bands/native/',

      annotationsLayout: 'histogram',
      chromosomes: ['17'],

      brush: 'chr17:5000000-10000000',
      onBrushMove: function() {},
      onLoad: function() {
        console.log('in onLoad')
        this.createBrush('17', 1, 2);
        this.createBrush('17', 40900000, 44900000);
        this.createBrush('17', 81094108, 81094109);
        console.log('after createBrush')

        // Closest test for https://github.com/eweitz/ideogram/issues/91
        var bandQ2131Left = getLeft('#chr17-9606-q21-31');
        var bandQ2131AnnotLeft = getLeft('#chr17-9606 .annot:nth-child(191)');
        var bandQ2131BrushLeft = getLeft('#_ideogram > g:nth-child(6) > rect.selection');
        // assert.equal(bandQ2131AnnotLeft, bandQ2131Left);
        // assert.equal(bandQ2131AnnotLeft, bandQ2131BrushLeft);
        console.log('after assert set 1')

        // Check alignment at far left
        var firstBpAnnotLeft = getLeft('#chr17-9606 > .annot:nth-child(51)');
        var firstBpSliderLeft = getLeft('#_ideogram > g:nth-child(5) > rect.selection');
        var firstBpLeft = getLeft('#chr17-9606');
        console.log('firstBpAnnotLeft')
        console.log(firstBpAnnotLeft)
        console.log('firstBpSliderLeft')
        console.log(firstBpSliderLeft)
        console.log('firstBpLeft')
        console.log(firstBpLeft)
        // assert.equal(firstBpAnnotLeft, firstBpSliderLeft);
        // assert.equal(firstBpSliderLeft, firstBpLeft);
        console.log('after assert set 2')

        // Check alignment at far right
        var lastBpAnnotRight = getRight('#chr17-9606 > .annot:nth-child(317)');
        var lastBpSliderRight = getRight('#_ideogram > g:nth-child(7) > rect.selection');
        var lastBpRight = getRight('#chr17-9606');
        // assert.isBelow(Math.abs(lastBpAnnotRight - lastBpSliderRight), 3);
        // assert.isBelow(Math.abs(lastBpSliderRight - lastBpRight), 3);
        console.log('after assert set 3')
      },

      orientation: 'horizontal',
      showBandLabels: true, // only work in horizontal mode

      annotations: [{
        name: 'first_band',
        chr: '17',
        start: 1,
        stop: 2
      },
      {
        name: 'band_q21-31',
        chr: '17',
        start: 40900000,
        stop: 40900001
      },
      {
        name: 'last_band_start',
        chr: '17',
        start: 75300000,
        stop: 75300001
      },
      {
        name: 'last_band_stop',
        chr: '17',
        start: 81195208,
        stop: 81195209
      }]
    };

    var ideogram = new Ideogram(config);
  </script>
</body>
</html>
